language: go

go:
  - 1.7

sudo: false

git:
  depth: 10

branches:
  only:
    - master

env:
  global:
    - SOURCE_DIR="public"
    - BUILD_BRANCH="source"
    - DEPLOY_BRANCH="master"

install:
  - rm -rf public || exit 0
  - go get -u -v github.com/spf13/hugo

script:
  - hugo

deploy:
  provider: pages
  skip_cleanup: true
  github_token: ${GITHUB_TOKEN} # Set in travis-ci.org dashboard
  repo: https://github.com/chchwy/chchwy.github.io
  target_branch: master
  local_dir: "public"
  on:
    branch: master